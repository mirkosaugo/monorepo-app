"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[954],{4056(e,n,s){s.d(n,{R:()=>r,x:()=>c});var a=s(2155);const i={},t=a.createContext(i);function r(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(t.Provider,{value:n},e.children)}},9570(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"packages/adding-packages","title":"Adding New Packages","description":"This guide walks you through adding a new shared package to the monorepo, using a utilities package as an example.","source":"@site/docs/packages/adding-packages.md","sourceDirName":"packages","slug":"/packages/adding-packages","permalink":"/packages/adding-packages","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"UI Library (@monorepo-app/ui)","permalink":"/packages/ui-library"},"next":{"title":"How Turborepo Works","permalink":"/guides/how-turborepo-works"}}');var i=s(5723),t=s(4056);const r={sidebar_position:3},c="Adding New Packages",l={},o=[{value:"Overview",id:"overview",level:2},{value:"Example: Creating a Utils Package",id:"example-creating-a-utils-package",level:2},{value:"Step 1: Create Directory Structure",id:"step-1-create-directory-structure",level:3},{value:"Step 2: Create package.json",id:"step-2-create-packagejson",level:3},{value:"Step 3: Create tsconfig.json",id:"step-3-create-tsconfigjson",level:3},{value:"Step 4: Create Utility Functions",id:"step-4-create-utility-functions",level:3},{value:"Step 5: Create Index File",id:"step-5-create-index-file",level:3},{value:"Step 6: Install Dependencies",id:"step-6-install-dependencies",level:3},{value:"Step 7: Use in an App",id:"step-7-use-in-an-app",level:3},{value:"Step 8: Configure App&#39;s tsconfig.json",id:"step-8-configure-apps-tsconfigjson",level:3},{value:"Other Package Examples",id:"other-package-examples",level:2},{value:"Config Package",id:"config-package",level:3},{value:"Types Package",id:"types-package",level:3},{value:"API Client Package",id:"api-client-package",level:3},{value:"Package Dependencies",id:"package-dependencies",level:2},{value:"Build Order",id:"build-order",level:2},{value:"Checklist",id:"checklist",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"adding-new-packages",children:"Adding New Packages"})}),"\n",(0,i.jsx)(n.p,{children:"This guide walks you through adding a new shared package to the monorepo, using a utilities package as an example."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"Adding a new package involves:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Creating the package directory"}),"\n",(0,i.jsx)(n.li,{children:"Configuring package.json"}),"\n",(0,i.jsx)(n.li,{children:"Creating the source files"}),"\n",(0,i.jsx)(n.li,{children:"Exporting from index.ts"}),"\n",(0,i.jsx)(n.li,{children:"Using in apps"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-creating-a-utils-package",children:"Example: Creating a Utils Package"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-directory-structure",children:"Step 1: Create Directory Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p packages/utils/src\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-packagejson",children:"Step 2: Create package.json"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"packages/utils/package.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "@monorepo-app/utils",\n  "version": "0.0.1",\n  "private": true,\n  "main": "./src/index.ts",\n  "types": "./src/index.ts",\n  "exports": {\n    ".": "./src/index.ts"\n  },\n  "scripts": {\n    "build": "tsc",\n    "lint": "eslint src/"\n  },\n  "devDependencies": {\n    "typescript": "^5.3.0"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-create-tsconfigjson",children:"Step 3: Create tsconfig.json"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"packages/utils/tsconfig.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "extends": "../../tsconfig.json",\n  "compilerOptions": {\n    "outDir": "./dist",\n    "rootDir": "./src",\n    "declaration": true,\n    "declarationMap": true\n  },\n  "include": ["src/**/*"],\n  "exclude": ["node_modules", "dist"]\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-create-utility-functions",children:"Step 4: Create Utility Functions"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"packages/utils/src/format.ts"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'/**\n * Formats a number as currency\n */\nexport function formatCurrency(\n  amount: number,\n  currency: string = "USD",\n  locale: string = "en-US"\n): string {\n  return new Intl.NumberFormat(locale, {\n    style: "currency",\n    currency,\n  }).format(amount);\n}\n\n/**\n * Formats a date in a human-readable format\n */\nexport function formatDate(\n  date: Date | string,\n  options?: Intl.DateTimeFormatOptions\n): string {\n  const d = typeof date === "string" ? new Date(date) : date;\n  return new Intl.DateTimeFormat("en-US", {\n    year: "numeric",\n    month: "long",\n    day: "numeric",\n    ...options,\n  }).format(d);\n}\n\n/**\n * Formats a number with thousands separators\n */\nexport function formatNumber(\n  num: number,\n  locale: string = "en-US"\n): string {\n  return new Intl.NumberFormat(locale).format(num);\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"packages/utils/src/validation.ts"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"/**\n * Validates an email address\n */\nexport function isValidEmail(email: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n}\n\n/**\n * Validates a URL\n */\nexport function isValidUrl(url: string): boolean {\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Checks if a string is empty or only whitespace\n */\nexport function isEmpty(str: string | null | undefined): boolean {\n  return !str || str.trim().length === 0;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"packages/utils/src/array.ts"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"/**\n * Groups an array by a key\n */\nexport function groupBy<T>(\n  array: T[],\n  key: keyof T\n): Record<string, T[]> {\n  return array.reduce((result, item) => {\n    const groupKey = String(item[key]);\n    if (!result[groupKey]) {\n      result[groupKey] = [];\n    }\n    result[groupKey].push(item);\n    return result;\n  }, {} as Record<string, T[]>);\n}\n\n/**\n * Removes duplicates from an array\n */\nexport function unique<T>(array: T[]): T[] {\n  return [...new Set(array)];\n}\n\n/**\n * Chunks an array into smaller arrays\n */\nexport function chunk<T>(array: T[], size: number): T[][] {\n  const chunks: T[][] = [];\n  for (let i = 0; i < array.length; i += size) {\n    chunks.push(array.slice(i, i + size));\n  }\n  return chunks;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-5-create-index-file",children:"Step 5: Create Index File"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"packages/utils/src/index.ts"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'// Format utilities\nexport {\n  formatCurrency,\n  formatDate,\n  formatNumber,\n} from "./format";\n\n// Validation utilities\nexport {\n  isValidEmail,\n  isValidUrl,\n  isEmpty,\n} from "./validation";\n\n// Array utilities\nexport {\n  groupBy,\n  unique,\n  chunk,\n} from "./array";\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-6-install-dependencies",children:"Step 6: Install Dependencies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pnpm install\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-7-use-in-an-app",children:"Step 7: Use in an App"}),"\n",(0,i.jsxs)(n.p,{children:["Add to your app's ",(0,i.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "dependencies": {\n    "@monorepo-app/utils": "workspace:*"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Then use in your code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'// apps/web/app/page.tsx\nimport { formatCurrency, formatDate, isValidEmail } from "@monorepo-app/utils";\n\nexport default function Home() {\n  return (\n    <div>\n      <p>Price: {formatCurrency(29.99)}</p>\n      <p>Date: {formatDate(new Date())}</p>\n      <p>Valid email: {isValidEmail("test@example.com") ? "Yes" : "No"}</p>\n    </div>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-8-configure-apps-tsconfigjson",children:"Step 8: Configure App's tsconfig.json"}),"\n",(0,i.jsx)(n.p,{children:"Add path alias for better imports:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "paths": {\n      "@monorepo-app/utils": ["../../packages/utils/src"],\n      "@monorepo-app/utils/*": ["../../packages/utils/src/*"]\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"other-package-examples",children:"Other Package Examples"}),"\n",(0,i.jsx)(n.h3,{id:"config-package",children:"Config Package"}),"\n",(0,i.jsx)(n.p,{children:"Shared configuration files:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"packages/config/\n\u251c\u2500\u2500 eslint/\n\u2502   \u2514\u2500\u2500 index.js\n\u251c\u2500\u2500 tailwind/\n\u2502   \u2514\u2500\u2500 index.ts\n\u251c\u2500\u2500 tsconfig/\n\u2502   \u251c\u2500\u2500 base.json\n\u2502   \u251c\u2500\u2500 nextjs.json\n\u2502   \u2514\u2500\u2500 react.json\n\u2514\u2500\u2500 package.json\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "@monorepo-app/config",\n  "exports": {\n    "./eslint": "./eslint/index.js",\n    "./tailwind": "./tailwind/index.ts",\n    "./tsconfig/base": "./tsconfig/base.json",\n    "./tsconfig/nextjs": "./tsconfig/nextjs.json"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Usage:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// apps/web/tsconfig.json\n{\n  "extends": "@monorepo-app/config/tsconfig/nextjs"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"types-package",children:"Types Package"}),"\n",(0,i.jsx)(n.p,{children:"Shared TypeScript types:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"packages/types/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 user.ts\n\u2502   \u251c\u2500\u2500 api.ts\n\u2502   \u2514\u2500\u2500 index.ts\n\u2514\u2500\u2500 package.json\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// packages/types/src/user.ts\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n  createdAt: Date;\n}\n\nexport interface UserProfile extends User {\n  avatar?: string;\n  bio?: string;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"api-client-package",children:"API Client Package"}),"\n",(0,i.jsx)(n.p,{children:"Shared API client:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"packages/api/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 client.ts\n\u2502   \u251c\u2500\u2500 endpoints/\n\u2502   \u2502   \u251c\u2500\u2500 users.ts\n\u2502   \u2502   \u2514\u2500\u2500 products.ts\n\u2502   \u2514\u2500\u2500 index.ts\n\u2514\u2500\u2500 package.json\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'// packages/api/src/client.ts\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || "http://localhost:3000/api";\n\nexport async function fetchApi<T>(\n  endpoint: string,\n  options?: RequestInit\n): Promise<T> {\n  const response = await fetch(`${API_BASE}${endpoint}`, {\n    headers: {\n      "Content-Type": "application/json",\n      ...options?.headers,\n    },\n    ...options,\n  });\n\n  if (!response.ok) {\n    throw new Error(`API error: ${response.status}`);\n  }\n\n  return response.json();\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"package-dependencies",children:"Package Dependencies"}),"\n",(0,i.jsx)(n.p,{children:"Packages can depend on other packages:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// packages/api/package.json\n{\n  "dependencies": {\n    "@monorepo-app/types": "workspace:*"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"build-order",children:"Build Order"}),"\n",(0,i.jsxs)(n.p,{children:["Turborepo handles build order automatically. If ",(0,i.jsx)(n.code,{children:"@monorepo-app/api"})," depends on ",(0,i.jsx)(n.code,{children:"@monorepo-app/types"}),", Turborepo will build ",(0,i.jsx)(n.code,{children:"@monorepo-app/types"})," first."]}),"\n",(0,i.jsx)(n.h2,{id:"checklist",children:"Checklist"}),"\n",(0,i.jsx)(n.p,{children:"When adding a new package:"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create directory in ",(0,i.jsx)(n.code,{children:"packages/"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create ",(0,i.jsx)(n.code,{children:"package.json"})," with unique ",(0,i.jsx)(n.code,{children:"@monorepo-app/"})," name"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create ",(0,i.jsx)(n.code,{children:"tsconfig.json"})," extending root"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create source files in ",(0,i.jsx)(n.code,{children:"src/"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Create ",(0,i.jsx)(n.code,{children:"src/index.ts"})," with exports"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Run ",(0,i.jsx)(n.code,{children:"pnpm install"})," from root"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Add to consuming apps' ",(0,i.jsx)(n.code,{children:"package.json"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Configure path aliases in consuming apps"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Test imports work correctly"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Run ",(0,i.jsx)(n.code,{children:"pnpm build"})," to verify no errors"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);